"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[17],{977:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"setup_guides/matter","title":"Matter","description":"Suggested setup guide for Matter","source":"@site/docs/setup_guides/matter.md","sourceDirName":"setup_guides","slug":"/setup_guides/matter","permalink":"/planck/docs/setup_guides/matter","draft":false,"unlisted":false,"editUrl":"https://github.com/YetAnotherClown/planck/edit/main/docs/setup_guides/matter.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Matter","description":"Suggested setup guide for Matter","sidebar_position":1},"sidebar":"defaultSidebar","previous":{"title":"Conditions","permalink":"/planck/docs/design/conditions"},"next":{"title":"Jecs","permalink":"/planck/docs/setup_guides/jecs"}}');var s=n(74848),l=n(28453);const a={title:"Matter",description:"Suggested setup guide for Matter",sidebar_position:1},c=void 0,i={},d=[{value:"Creating the World",id:"creating-the-world",level:3},{value:"Creating the Scheduler",id:"creating-the-scheduler",level:3},{value:"Making Components",id:"making-components",level:3},{value:"Creating Your First Systems",id:"creating-your-first-systems",level:3},{value:"Your Startup Function",id:"your-startup-function",level:3},{value:"Server / Client Scripts",id:"server--client-scripts",level:3}];function o(e){const r={admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.p,{children:"Recommended project structure"}),"\n",(0,s.jsxs)("pre",{style:{lineHeight:"120%",width:"fit-content","--ifm-paragraph-margin-bottom":0},children:[(0,s.jsx)(r.p,{children:"ReplicatedStorage/\r\n\u251c\u2500 Packages/\r\n\u2502  \u251c\u2500 Matter.luau\r\n\u2502  \u251c\u2500 Planck.luau\r\n\u2502  \u251c\u2500 DebuggerPlugin.luau\r\n\u2502  \u251c\u2500 HooksPlugin.luau\r\n\u251c\u2500 client/\r\n\u2502  \u251c\u2500 systems/\r\n\u251c\u2500 shared/\r\n\u2502  \u251c\u2500 systems/\r\n\u2502  \u251c\u2500 components.luau\r\n\u2502  \u251c\u2500 scheduler.luau\r\n\u2502  \u251c\u2500 startup.luau\r\n\u2502  \u251c\u2500 world.luau"}),(0,s.jsx)("br",{}),(0,s.jsx)(r.p,{children:"ServerScriptService/\r\n\u251c\u2500 server/\r\n\u2502  \u251c\u2500 systems/\r\n\u2502  \u251c\u2500 server.server.luau"}),(0,s.jsx)("br",{}),(0,s.jsx)(r.p,{children:"StarterPlayerScripts/\r\n\u251c\u2500 client.client.luau"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-toml",metastring:'title="wally.toml"',children:'[dependencies]\r\nMatter = "matter-ecs/matter@0.8.4"\r\nPlanck = "yetanotherclown/planck@0.2.0-rc.1"\r\nPlanckMatterDebugger = "yetanotherclown/planck-matter-debugger@0.2.0-rc.1"\r\nPlanckMatterHooks = "yetanotherclown/planck-matter-hooks@0.2.0-rc.1"\n'})}),"\n",(0,s.jsx)(r.h3,{id:"creating-the-world",children:"Creating the World"}),"\n",(0,s.jsxs)(r.p,{children:["First, we'll create a module called ",(0,s.jsx)(r.code,{children:"world.luau"})," where we create and export our Matter World."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/world.luau"',children:'local Matter = require("@packages/Matter")\r\nlocal World = Matter.World\r\n\r\nlocal world = World.new()\r\n\r\nreturn world\n'})}),"\n",(0,s.jsx)(r.h3,{id:"creating-the-scheduler",children:"Creating the Scheduler"}),"\n",(0,s.jsxs)(r.p,{children:["Next, we'll create a module called ",(0,s.jsx)(r.code,{children:"scheduler.luau"})," where we create and export our scheduler."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/scheduler.luau"',children:'local Planck = require("@packages/Planck")\r\nlocal Scheduler = Planck.Scheduler\r\n\r\nlocal scheduler = scheduler.new()\r\n\r\nreturn scheduler\n'})}),"\n",(0,s.jsx)(r.p,{children:"Then lets pass the world to our scheduler"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'{4,6}title="ReplicatedStorage/shared/scheduler.luau"',children:'local Planck = require("@packages/Planck")\r\nlocal Scheduler = Planck.Scheduler\r\n\r\nlocal world = require("@shared/world")\r\n\r\nlocal scheduler = scheduler.new(world)\r\n\r\nreturn scheduler\n'})}),"\n",(0,s.jsx)(r.p,{children:"And then let's add our Hooks Plugin (we will add the Debugger plugin later)"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'{6,7,10} title="ReplicatedStorage/shared/scheduler.luau"',children:'local Matter = require("@packages/Matter")\r\nlocal Plasma = require("@packages/Plasma")\r\n\r\nlocal Planck = require("@packages/Planck")\r\nlocal Scheduler = Planck.Scheduler\r\n\r\nlocal world = require("@shared/world")\r\n\r\nlocal DebuggerPlugin = require("@packages/DebuggerPlugin")\r\nlocal debuggerPlugin = DebuggerPlugin.new({ world })\r\n\r\nlocal debugger = Matter.Debugger.new(Plasma)\r\nlocal widgets = debugger:getWidgets()\r\n\r\nlocal HooksPlugin = require("@packages/HooksPlugin")\r\nlocal hooksPlugin = HooksPlugin.new()\r\n\r\nlocal scheduler = scheduler.new(world, widgets)\r\n    :addPlugin(hooksPlugin)\r\n    :addPlugin(debuggerPlugin)\r\n\r\ndebugger:autoInitialize(debuggerPlugin:getLoop())\r\n\r\nreturn scheduler\n'})}),"\n",(0,s.jsx)(r.h3,{id:"making-components",children:"Making Components"}),"\n",(0,s.jsxs)(r.p,{children:["We'll store our Matter components in a ",(0,s.jsx)(r.code,{children:"components.luau"})," module."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/components.luau"',children:'local Matter = require("@packages/Matter")\r\n\r\nreturn {\r\n    MyComponent = Matter.component("myComponent"),\r\n}\n'})}),"\n",(0,s.jsx)(r.h3,{id:"creating-your-first-systems",children:"Creating Your First Systems"}),"\n",(0,s.jsx)(r.p,{children:"Let's create a basic system with Planck + Matter"}),"\n",(0,s.jsxs)(r.p,{children:["In Startup systems, we can perform startup logic such as setting up\r\nour initial entities, hence it running on the ",(0,s.jsx)(r.code,{children:"Startup"})," phase."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/systems/systemA.luau"',children:'local Matter = require("@packages/Matter")\r\n\r\nlocal Planck = require("@packages/Planck")\r\nlocal Phase = Planck.Phase\r\n\r\nlocal components = require("@shared/components")\r\n\r\nlocal function systemA(world)\r\n    -- Runs only once before all other Phases\r\nend\r\n\r\nreturn {\r\n    system = systemA\r\n    phase = Phase.Startup\r\n}\n'})}),"\n",(0,s.jsx)(r.p,{children:"To create a normal system, we do not need to provide a Phase."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/systems/systemB.luau"',children:"local function systemB(world)\r\n    -- ...\r\nend\r\n\r\nreturn systemB\n"})}),"\n",(0,s.jsx)(r.p,{children:"Notice how you can define systems as either a function or a table!"}),"\n",(0,s.jsxs)(r.p,{children:["While you can set the phase directly in ",(0,s.jsx)(r.code,{children:"Scheduler:addSystem(fn, phase)"}),",\r\nit may be convenient to use a System Table instead."]}),"\n",(0,s.jsxs)(r.admonition,{type:"note",children:[(0,s.jsxs)(r.p,{children:["Notice how we pass ",(0,s.jsx)(r.code,{children:"world"})," into our system functions instead of requiring the\r\nmodule we made."]}),(0,s.jsx)(r.p,{children:"We do this to keep systems pure, we avoid external dependencies by passing our\r\ndependencies as function parameters. This makes our systems more testable and\r\nreusable."})]}),"\n",(0,s.jsx)(r.h3,{id:"your-startup-function",children:"Your Startup Function"}),"\n",(0,s.jsx)(r.p,{children:"Your Startup function is where you first require the world and scheduler modules,\r\nwhere you would add your systems to the scheduler, and where we will setup our Debugger."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/shared/startup.luau"',children:'local scheduler = require("@shared/scheduler")\r\nlocal world = require("@shared/world")\r\n\r\nreturn function(systems)\r\n    scheduler\r\n        :addSystems(systems) -- Assuming you\'re using SystemTables!\r\nend\n'})}),"\n",(0,s.jsx)(r.h3,{id:"server--client-scripts",children:"Server / Client Scripts"}),"\n",(0,s.jsxs)(r.p,{children:["On the client, we'll add the ",(0,s.jsx)(r.code,{children:"shared"})," and ",(0,s.jsx)(r.code,{children:"client"})," systems."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'title="ReplicatedStorage/client/client.client.luau"',children:'local ReplicatedStorage = game:GetService("ReplicatedStorage")\r\n\r\nlocal startup = require("@shared/startup")\r\n\r\nlocal systems = {}\r\n\r\nlocal function addSystems(folder)\r\n    for _, system in folder:GetChildren() do\r\n        if not system:IsA("ModuleScript") then\r\n            continue\r\n        end\r\n\r\n        table.insert(systems, require(system))\r\n    end\r\nend\r\n\r\naddSystems(ReplicatedStorage.shared.systems)\r\naddSystems(ReplicatedStorage.client.systems)\r\n\r\nstartup(systems)\n'})}),"\n",(0,s.jsxs)(r.p,{children:["On the server, we'll instead add the ",(0,s.jsx)(r.code,{children:"server"})," systems."]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-lua",metastring:'{18} title="ServerScriptService/server/server.server.luau"',children:'local ReplicatedStorage = game:GetService("ReplicatedStorage")\r\n\r\nlocal startup = require("@shared/startup")\r\n\r\nlocal systems = {}\r\n\r\nlocal function addSystems(folder)\r\n    for _, system in folder:GetChildren() do\r\n        if not system:IsA("ModuleScript") then\r\n            continue\r\n        end\r\n\r\n        table.insert(systems, require(system))\r\n    end\r\nend\r\n\r\naddSystems(ReplicatedStorage.shared.systems)\r\naddSystems(ReplicatedStorage.server.systems)\r\n\r\nstartup(systems)\n'})})]})}function u(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>a,x:()=>c});var t=n(96540);const s={},l=t.createContext(s);function a(e){const r=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(l.Provider,{value:r},e.children)}}}]);